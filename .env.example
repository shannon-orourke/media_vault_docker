# MediaVault Environment Configuration
# Copy this to .env and fill in your values

# ============================================================================
# DATABASE
# ============================================================================
DATABASE_URL=postgresql://pm_ideas_user:YOUR_PASSWORD@localhost:5433/mediavault
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# ============================================================================
# SECURITY
# ============================================================================
JWT_SECRET_KEY=YOUR_RANDOM_SECRET_KEY_HERE_CHANGE_ME
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440  # 24 hours

# First user becomes superuser automatically
ALLOW_REGISTRATION=false

# ============================================================================
# NAS CONFIGURATION
# ============================================================================
NAS_HOST=10.27.10.11
NAS_SMB_USERNAME=ProxmoxBackupsSMB
NAS_SMB_PASSWORD=CHANGE_ME
NAS_SMB_SHARE=volume1
NAS_MOUNT_PATH=/mnt/nas-media

# Scan paths (comma-separated)
NAS_SCAN_PATHS=/volume1/docker,/volume1/videos

# Temp deletion staging area
NAS_TEMP_DELETE_PATH=/volume1/video/duplicates_before_purge
LOCAL_TEMP_DELETE_PATH=./tmp/duplicates_before_purge
DEV_MEDIA_FALLBACK_PATH=

# ============================================================================
# TMDB API (The Movie Database)
# ============================================================================
TMDB_API_KEY=YOUR_TMDB_API_KEY
TMDB_READ_ACCESS_TOKEN=YOUR_TMDB_READ_TOKEN
TMDB_BASE_URL=https://api.themoviedb.org/3/
TMDB_RATE_LIMIT=40  # requests per 10 seconds

# ============================================================================
# OMDB API (Future - IMDb data source of truth)
# ============================================================================
# OMDB_API_KEY=YOUR_OMDB_KEY_HERE
# OMDB_BASE_URL=http://www.omdbapi.com/
# OMDB_DAILY_LIMIT=1000

# ============================================================================
# AZURE OPENAI (Chat with Your Data)
# ============================================================================
AZURE_OPENAI_KEY=YOUR_AZURE_OPENAI_KEY
AZURE_OPENAI_ENDPOINT=https://eastus.api.cognitive.microsoft.com/
AZURE_OPENAI_API_VERSION=2024-08-01-preview

# Chat model deployment
AZURE_DEPLOYMENT_NAME_CHAT=gpt-4o
AZURE_DEPLOYMENT_NAME_CHAT_MINI=gpt-4o-mini

# Token budgeting (optional)
AZURE_OPENAI_MAX_TOKENS_PER_DAY=100000

# ============================================================================
# APPLICATION
# ============================================================================
APP_NAME=MediaVault
APP_VERSION=0.1.0
ENVIRONMENT=production  # development, staging, production

# Server
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8007
FRONTEND_PORT=3007

# CORS (Cloudflare domain)
CORS_ORIGINS=https://mediavault.orourkes.me,http://localhost:3007,http://10.27.10.104:3007

# ============================================================================
# FFMPEG / MEDIAINFO
# ============================================================================
FFMPEG_PATH=/usr/bin/ffmpeg
FFPROBE_PATH=/usr/bin/ffprobe
MEDIAINFO_PATH=/usr/bin/mediainfo

# MD5 hash chunk size (bytes)
MD5_CHUNK_SIZE=8192

# ============================================================================
# DUPLICATE DETECTION
# ============================================================================
# Fuzzy match threshold (0-100)
FUZZY_MATCH_THRESHOLD=85

# Quality difference thresholds
QUALITY_AUTO_APPROVE_THRESHOLD=50   # Auto-approve if difference > 50 points
QUALITY_MANUAL_REVIEW_THRESHOLD=20  # Require review if difference < 20 points

# Maximum duplicates to process per batch
MAX_DUPLICATES_PER_BATCH=100

# ============================================================================
# DELETION POLICY
# ============================================================================
# Manual approval only (never auto-delete)
AUTO_DELETE_ENABLED=false

# Retention period for pending deletions (days, not used if auto-delete disabled)
PENDING_DELETION_RETENTION_DAYS=30

# Temp directory structure
# /volume1/video/duplicates_before_purge/{media_type}/{date}/
TEMP_DELETE_SUBDIRS=movies,tv,documentaries

# ============================================================================
# LANGUAGE DETECTION
# ============================================================================
# Trust heuristic for foreign film detection
# (non-English audio + English subs = foreign film)
TRUST_FOREIGN_FILM_HEURISTIC=true

# Require English audio for non-foreign films
REQUIRE_ENGLISH_AUDIO=true

# ============================================================================
# SCANNING
# ============================================================================
# Scan types: full, incremental
DEFAULT_SCAN_TYPE=full

# Max concurrent file processing
SCAN_MAX_WORKERS=5

# Scan timeout (seconds)
SCAN_TIMEOUT=3600

# Video file extensions to scan
VIDEO_EXTENSIONS=.mkv,.mp4,.avi,.m4v,.mov,.wmv,.flv,.webm,.mpg,.mpeg,.ts

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FILE=/var/log/mediavault/mediavault.log
LOG_MAX_BYTES=10485760  # 10 MB
LOG_BACKUP_COUNT=5

# ============================================================================
# LANGFUSE / TRACEFORGE (Observability)
# ============================================================================
# Organization: Minerva (same as Bimodal Agent)
# Create "mediavault" project in Langfuse UI and copy keys here
LANGFUSE_PUBLIC_KEY=pk-lf-YOUR_MEDIAVAULT_PROJECT_KEY_HERE
LANGFUSE_SECRET_KEY=sk-lf-YOUR_MEDIAVAULT_PROJECT_SECRET_HERE
LANGFUSE_HOST=http://10.27.10.104:3010
LANGFUSE_PROJECT_ID=cm_YOUR_MEDIAVAULT_PROJECT_ID_HERE

# Optional: TraceForge API (centralized collection)
# TRACEFORGE_API_URL=http://10.27.10.104:3011
# TRACEFORGE_ENABLED=true

# ============================================================================
# REDIS (Optional - for background tasks with Celery)
# ============================================================================
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_DB=0
# CELERY_BROKER_URL=redis://localhost:6379/0
# CELERY_RESULT_BACKEND=redis://localhost:6379/0
